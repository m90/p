(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.Promise=t(e.Promise)}})(this,function(e){function t(e){return typeof e==="undefined"}function n(e){return Object.prototype.toString.call(e)==="[object Function]"}function i(e){return Object.prototype.toString.call(e)==="[object Object]"}function r(e,t,n){var i=false;try{e(function(e){if(i)return;i=true;t(e)},function(e){if(i)return;i=true;n(e)})}catch(r){if(i)return;i=true;n(r)}}var o={PENDING:0,FULFILLED:1,REJECTED:2};var u=function(){if(this.process&&n(this.process.nextTick)){return this.process.nextTick}else if(this.setImmediate){return this.setImmediate}else{return function(e){setTimeout(e,0)}}}();function f(e){if(!i(this)){return new f(e)}var c=this,s=n(e)?null:e,l=n(e)||t(e)?o.PENDING:o.FULFILLED,h=null,a=[];function L(e){if(l===o.PENDING){a.push(e)}else{u(function(){var t=l===o.FULFILLED?e.onFulfilled:e.onRejected;if(!n(t)){if(l===o.FULFILLED){e.resolve(s)}else{e.reject(h)}}else{var i;try{i=t(l===o.FULFILLED?s:h)}catch(r){e.reject(r);return}e.resolve(i)}})}}function E(e){if(e===c){p(new TypeError("Cannot resolve with self"))}if(l===o.REJECTED)return;try{if(i(e)||n(e)){var t=e.then;if(n(t)){r(t.bind(e),E,p);return}}l=o.FULFILLED;s=e;F()}catch(u){p(u)}}function p(e){if(l===o.FULFILLED)return;l=o.REJECTED;h=e;F()}function F(){while(a.length){L(a.shift())}}this.then=function(e,t){return new f(function(n,i){L({onFulfilled:e,onRejected:t,resolve:n,reject:i})})};if(n(e)){r(e,E,p)}else if(t(e)){this.resolve=function(){E.apply(this,[].slice.call(arguments));return this};this.reject=function(){p.apply(this,[].slice.call(arguments));return this};this.promise=function(){return{then:this.then}}}else{E(s)}}f.all=function(e){return new f(function(t,r){var o=[],u=e.length;function f(e,c){if(i(c)&&n(c.then)){c.then(function(t){f(e,t)},r)}else{o[e]=c;u--;if(!u){t(o)}}}for(var c=0;c<e.length;c++){f(c,e[c])}})};f.noConflict=function(){this.Promise=e;return f}.bind(this);return f});